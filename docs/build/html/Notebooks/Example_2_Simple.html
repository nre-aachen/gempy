<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Example 2: Simple model &#8212; GeMpy 2 documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Example 3: Simple model PyMC" href="Example_3_Simple_PyMC.html" />
    <link rel="prev" title="Example 1: Sandstone Model" href="Example_1_Sandstone_Project.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="example-2-simple-model">
<h1>Example 2: Simple model<a class="headerlink" href="#example-2-simple-model" title="Permalink to this headline">¶</a></h1>
<p>This notebook is a series of independent cells showing how to create a
simple model from the beginning to the end using GeMpy</p>
<div class="section" id="importing-dependencies">
<h2>Importing dependencies<a class="headerlink" href="#importing-dependencies" title="Permalink to this headline">¶</a></h2>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Importing</span>
<span class="kn">import</span> <span class="nn">theano.tensor</span> <span class="k">as</span> <span class="nn">T</span>
<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;../GeMpy&quot;</span><span class="p">)</span>

<span class="c1"># Importing GeMpy modules</span>
<span class="kn">import</span> <span class="nn">GeMpy</span>

<span class="c1"># Reloading (only for development purposes)</span>
<span class="kn">import</span> <span class="nn">importlib</span>
<span class="n">importlib</span><span class="o">.</span><span class="n">reload</span><span class="p">(</span><span class="n">GeMpy</span><span class="p">)</span>

<span class="c1"># Usuful packages</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pn</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># This was to choose the gpu</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CUDA_LAUNCH_BLOCKING&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span>

<span class="c1"># Default options of printin</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span> <span class="mi">130</span><span class="p">,</span> <span class="n">suppress</span> <span class="o">=</span>  <span class="kc">True</span><span class="p">)</span>

<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="c1">#%matplotlib notebook</span>
</pre></div>
</div>
<div class="section" id="visualize-data">
<h3>Visualize data<a class="headerlink" href="#visualize-data" title="Permalink to this headline">¶</a></h3>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Setting the extent</span>
<span class="n">geo_data</span> <span class="o">=</span> <span class="n">GeMpy</span><span class="o">.</span><span class="n">import_data</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="n">GeMpy</span><span class="o">.</span><span class="n">get_raw_data</span><span class="p">(</span><span class="n">geo_data</span><span class="p">)</span>
</pre></div>
</div>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>G_x</th>
      <th>G_y</th>
      <th>G_z</th>
      <th>X</th>
      <th>Y</th>
      <th>Z</th>
      <th>azimuth</th>
      <th>dip</th>
      <th>formation</th>
      <th>polarity</th>
      <th>series</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div><div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="c1"># =========================</span>
<span class="c1"># DATA GENERATION IN PYTHON</span>
<span class="c1"># =========================</span>
<span class="c1"># Layers coordinates</span>
<span class="n">layer_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mf">6.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span><span class="c1">#-np.array([5,5,4]))/8+0.5</span>
<span class="n">layer_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>
<span class="n">layers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">layer_1</span><span class="p">,</span><span class="n">layer_2</span><span class="p">])</span>

<span class="c1"># Foliations coordinates</span>
<span class="n">dip_pos_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span><span class="c1">#- np.array([5,5,4]))/8+0.5</span>
<span class="n">dip_pos_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>

<span class="c1"># Dips</span>
<span class="n">dip_angle_1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="n">dip_angle_2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="mi">340</span><span class="p">)</span>
<span class="n">dips_angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">dip_angle_1</span><span class="p">,</span> <span class="n">dip_angle_2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span><span class="p">)</span>

<span class="c1"># Azimuths</span>
<span class="n">azimuths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span><span class="p">)</span>

<span class="c1"># Polarity</span>
<span class="n">polarity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Setting foliations and interfaces values</span>
<span class="n">GeMpy</span><span class="o">.</span><span class="n">set_interfaces</span><span class="p">(</span><span class="n">geo_data</span><span class="p">,</span> <span class="n">pn</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;X&quot;</span> <span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">layer_1</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span><span class="n">layer_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]),</span>
            <span class="s2">&quot;Y&quot;</span> <span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">layer_1</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span><span class="n">layer_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]),</span>
            <span class="s2">&quot;Z&quot;</span> <span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">layer_1</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span><span class="n">layer_2</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]),</span>
            <span class="s2">&quot;formation&quot;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
               <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="s2">&quot;Layer 1&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">layer_1</span><span class="p">)),</span>
               <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="s2">&quot;Layer 2&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">layer_2</span><span class="p">))),</span>
            <span class="s2">&quot;labels&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">r&#39;${\bf</span><span class="si">{x}</span><span class="s1">}_{\alpha \, 0}^1$&#39;</span><span class="p">,</span>
               <span class="s1">r&#39;${\bf</span><span class="si">{x}</span><span class="s1">}_{\alpha \, 1}^1$&#39;</span><span class="p">,</span>
               <span class="s1">r&#39;${\bf</span><span class="si">{x}</span><span class="s1">}_{\alpha \, 2}^1$&#39;</span><span class="p">,</span>
               <span class="s1">r&#39;${\bf</span><span class="si">{x}</span><span class="s1">}_{\alpha \, 3}^1$&#39;</span><span class="p">,</span>
               <span class="s1">r&#39;${\bf</span><span class="si">{x}</span><span class="s1">}_{\alpha \, 0}^2$&#39;</span><span class="p">,</span>
               <span class="s1">r&#39;${\bf</span><span class="si">{x}</span><span class="s1">}_{\alpha \, 1}^2$&#39;</span><span class="p">,</span>
               <span class="s1">r&#39;${\bf</span><span class="si">{x}</span><span class="s1">}_{\alpha \, 2}^2$&#39;</span><span class="p">,</span>
               <span class="s1">r&#39;${\bf</span><span class="si">{x}</span><span class="s1">}_{\alpha \, 3}^2$&#39;</span><span class="p">,</span>
               <span class="s1">r&#39;${\bf</span><span class="si">{x}</span><span class="s1">}_{\alpha \, 4}^2$&#39;</span><span class="p">]</span> <span class="p">}))</span>

<span class="n">GeMpy</span><span class="o">.</span><span class="n">set_foliations</span><span class="p">(</span><span class="n">geo_data</span><span class="p">,</span>  <span class="n">pn</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;X&quot;</span> <span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dip_pos_1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">dip_pos_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
            <span class="s2">&quot;Y&quot;</span> <span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dip_pos_1</span><span class="p">[</span> <span class="mi">1</span><span class="p">],</span><span class="n">dip_pos_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
            <span class="s2">&quot;Z&quot;</span> <span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dip_pos_1</span><span class="p">[</span> <span class="mi">2</span><span class="p">],</span><span class="n">dip_pos_2</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
            <span class="s2">&quot;azimuth&quot;</span> <span class="p">:</span> <span class="n">azimuths</span><span class="p">,</span>
            <span class="s2">&quot;dip&quot;</span> <span class="p">:</span> <span class="n">dips_angles</span><span class="p">,</span>
            <span class="s2">&quot;polarity&quot;</span> <span class="p">:</span> <span class="n">polarity</span><span class="p">,</span>
            <span class="s2">&quot;formation&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Layer 1&quot;</span><span class="p">,</span> <span class="s2">&quot;Layer 2&quot;</span><span class="p">],</span>
            <span class="s2">&quot;labels&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">r&#39;${\bf</span><span class="si">{x}</span><span class="s1">}_{\beta \,</span><span class="si">{0}</span><span class="s1">}$&#39;</span><span class="p">,</span>
              <span class="s1">r&#39;${\bf</span><span class="si">{x}</span><span class="s1">}_{\beta \,</span><span class="si">{1}</span><span class="s1">}$&#39;</span><span class="p">]</span> <span class="p">}))</span>

<span class="n">GeMpy</span><span class="o">.</span><span class="n">get_raw_data</span><span class="p">(</span><span class="n">geo_data</span><span class="p">)</span>
</pre></div>
</div>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>G_x</th>
      <th>G_y</th>
      <th>G_z</th>
      <th>X</th>
      <th>Y</th>
      <th>Z</th>
      <th>azimuth</th>
      <th>dip</th>
      <th>formation</th>
      <th>labels</th>
      <th>polarity</th>
      <th>series</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="9" valign="top">interfaces</th>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.5</td>
      <td>4.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Layer 1</td>
      <td>${\bf{x}}_{\alpha \, 0}^1$</td>
      <td>NaN</td>
      <td>Default serie</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Layer 1</td>
      <td>${\bf{x}}_{\alpha \, 1}^1$</td>
      <td>NaN</td>
      <td>Default serie</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Layer 1</td>
      <td>${\bf{x}}_{\alpha \, 2}^1$</td>
      <td>NaN</td>
      <td>Default serie</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Layer 1</td>
      <td>${\bf{x}}_{\alpha \, 3}^1$</td>
      <td>NaN</td>
      <td>Default serie</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Layer 2</td>
      <td>${\bf{x}}_{\alpha \, 0}^2$</td>
      <td>NaN</td>
      <td>Default serie</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Layer 2</td>
      <td>${\bf{x}}_{\alpha \, 1}^2$</td>
      <td>NaN</td>
      <td>Default serie</td>
    </tr>
    <tr>
      <th>6</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Layer 2</td>
      <td>${\bf{x}}_{\alpha \, 2}^2$</td>
      <td>NaN</td>
      <td>Default serie</td>
    </tr>
    <tr>
      <th>7</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Layer 2</td>
      <td>${\bf{x}}_{\alpha \, 3}^2$</td>
      <td>NaN</td>
      <td>Default serie</td>
    </tr>
    <tr>
      <th>8</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Layer 2</td>
      <td>${\bf{x}}_{\alpha \, 4}^2$</td>
      <td>NaN</td>
      <td>Default serie</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">foliations</th>
      <th>0</th>
      <td>0.258819</td>
      <td>1.584810e-17</td>
      <td>0.965926</td>
      <td>7.0</td>
      <td>4.0</td>
      <td>7.0</td>
      <td>90.0</td>
      <td>15.0</td>
      <td>Layer 1</td>
      <td>${\bf{x}}_{\beta \,{0}}$</td>
      <td>1.0</td>
      <td>Default serie</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.342020</td>
      <td>-2.094269e-17</td>
      <td>0.939693</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>90.0</td>
      <td>340.0</td>
      <td>Layer 2</td>
      <td>${\bf{x}}_{\beta \,{1}}$</td>
      <td>1.0</td>
      <td>Default serie</td>
    </tr>
  </tbody>
</table>
</div><div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Plotting data</span>
<span class="n">GeMpy</span><span class="o">.</span><span class="n">plot_data</span><span class="p">(</span><span class="n">geo_data</span><span class="p">)</span>
<span class="n">GeMpy</span><span class="o">.</span><span class="n">PlotData</span><span class="o">.</span><span class="n">annotate_plot</span><span class="p">(</span><span class="n">GeMpy</span><span class="o">.</span><span class="n">get_raw_data</span><span class="p">(</span><span class="n">geo_data</span><span class="p">),</span>
                             <span class="s1">&#39;labels&#39;</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="s1">&#39;x-large&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/Example_2_Simple_8_0.png" src="../_images/Example_2_Simple_8_0.png" />
</div>
</div>
<div class="section" id="interactive-pandas-dataframe">
<h2>Interactive pandas Dataframe<a class="headerlink" href="#interactive-pandas-dataframe" title="Permalink to this headline">¶</a></h2>
<p>Using qgrid it is possible to modify the tables in place as following:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">GeMpy</span><span class="o">.</span><span class="n">i_set_data</span><span class="p">(</span><span class="n">geo_data</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="grid-and-potential-field">
<h3>Grid and potential field<a class="headerlink" href="#grid-and-potential-field" title="Permalink to this headline">¶</a></h3>
<p>We can see the potential field generated out of the data above</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">GeMpy</span><span class="o">.</span><span class="n">set_interpolator</span><span class="p">(</span><span class="n">geo_data</span><span class="p">,</span> <span class="n">u_grade</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">GeMpy</span><span class="o">.</span><span class="n">plot_potential_field</span><span class="p">(</span><span class="n">geo_data</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">colorbar</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;magma&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/Example_2_Simple_12_0.png" src="../_images/Example_2_Simple_12_0.png" />
<div class="code python highlight-default"><div class="highlight"><pre><span></span>from ipywidgets import widgets
from ipywidgets import interact
def cov_cubic_f(r,a = 6, c_o = 1):↔
def cov_cubic_d1_f(r,a = 6., c_o = 1):↔

def cov_cubic_d2_f(r, a = 6, c_o = 1):↔

def plot_potential_var(a = 10, c_o = 1, nugget_effect = 0):↔

def plot_potential_direction_var( a = 10, c_o = 1, nugget_effect = 0):↔

def plot_directionU_directionU_var(a = 10, c_o = 1, nugget_effect = 0):↔

    plt.title(&quot;Variogram&quot;)
    plt.margins(0,0.1)

    ax2 = fig.add_subplot(122)
    ax2.plot(x,np.asarray(y))
    ax2.scatter(0,nugget_effect+y[0], s = 20)

    plt.title(&quot;Covariance Function&quot;)
    plt.tight_layout()
    plt.margins(0,0.1)
    plt.suptitle(&#39;$C_{\partial {Z}/ \partial x, \, \partial {Z}/ \partial x}(h_x)$&#39;
                 , y = 1.08, fontsize=15)

def plot_directionU_directionV_var(a = 10, c_o = 1, nugget_effect = 0):↔

    plt.title(&quot;Variogram&quot;)
    plt.margins(0,0.1)

    ax2 = fig.add_subplot(122)
    ax2.plot(x,np.asarray(y))
    ax2.scatter(0,nugget_effect+y[0], s = 20)
    plt.title(&quot;Covariance Function&quot;)
    plt.tight_layout()
    plt.margins(0,0.1)
    plt.suptitle(&#39;$C_{\partial {Z}/ \partial x, \, \partial {Z}/ \partial y}(h_x,h_y)$&#39;
                 , y = 1.08, fontsize=15)


def plot_all(a = 10, c_o = 1, nugget_effect = 0):↔
</pre></div>
</div>
</div>
<div class="section" id="from-potential-field-to-block">
<h3>From potential field to block<a class="headerlink" href="#from-potential-field-to-block" title="Permalink to this headline">¶</a></h3>
<p>The potential field describe the deposition form and direction of a
basin. However, in most scenarios the real goal of structural modeling
is the segmentation in layers of areas with significant change of
properties (e.g. shales and carbonates). Since we need to provide at
least one point per interface, we can easily compute the value of the
potential field at the intersections between two layers. Therefore, by
simple comparison between a concrete value of the potential field and
the values of the interfaces it is possible to segment the domain into
layers Fig X.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">GeMpy</span><span class="o">.</span><span class="n">compute_block_model</span><span class="p">(</span><span class="n">geo_data</span><span class="p">)</span>
<span class="n">GeMpy</span><span class="o">.</span><span class="n">plot_section</span><span class="p">(</span><span class="n">geo_data</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">Visualization</span><span class="o">.</span><span class="n">PlotData</span> <span class="n">at</span> <span class="mh">0x7fb7d1e4c208</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="../_images/Example_2_Simple_16_1.png" src="../_images/Example_2_Simple_16_1.png" />
</div>
</div>
<div class="section" id="combining-potential-fields-depositional-series">
<h2>Combining potential fields: Depositional series<a class="headerlink" href="#combining-potential-fields-depositional-series" title="Permalink to this headline">¶</a></h2>
<p>In reality, most geological settings are formed by a concatenation of
depositional phases separated clearly by unconformity bounderies. Each
of these phases can be model by a potential field. In order to capture
this behavior, we can classify the formations that belong to individual
depositional phase into categories or series. The potential field
computed for each of these series could be seen as a sort of evolution
of the basin if an unconformity did not occur. Finally, sorting the
temporal relation between series allow to superpose the corresponding
potential field at an specific location.</p>
<p>In the next example, we add a new serie consisting in a layer&#8212;&#8217;Layer
3&#8217;&#8212; Fig X, which generate the potential field of Fig X and
subsequently the block Figure X.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">layer_3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>
<span class="n">dip_pos_3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">dip_angle_3</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>
<span class="n">azimuth_3</span> <span class="o">=</span> <span class="mi">90</span>
<span class="n">polarity_3</span> <span class="o">=</span> <span class="mi">1</span>



<span class="n">GeMpy</span><span class="o">.</span><span class="n">set_interfaces</span><span class="p">(</span><span class="n">geo_data</span><span class="p">,</span> <span class="n">pn</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;X&quot;</span> <span class="p">:</span><span class="n">layer_3</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;Y&quot;</span> <span class="p">:</span><span class="n">layer_3</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="s2">&quot;Z&quot;</span> <span class="p">:</span><span class="n">layer_3</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span>
            <span class="s2">&quot;formation&quot;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="s2">&quot;Layer 3&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">layer_3</span><span class="p">)),</span>
            <span class="s2">&quot;labels&quot;</span> <span class="p">:</span> <span class="p">[</span>  <span class="s1">r&#39;${\bf</span><span class="si">{x}</span><span class="s1">}_{\alpha \, 0}^3$&#39;</span><span class="p">,</span>
                           <span class="s1">r&#39;${\bf</span><span class="si">{x}</span><span class="s1">}_{\alpha \, 1}^3$&#39;</span><span class="p">,</span>
                           <span class="s1">r&#39;${\bf</span><span class="si">{x}</span><span class="s1">}_{\alpha \, 2}^3$&#39;</span><span class="p">]</span> <span class="p">}),</span> <span class="n">append</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">GeMpy</span><span class="o">.</span><span class="n">get_raw_data</span><span class="p">(</span><span class="n">geo_data</span><span class="p">,</span><span class="s2">&quot;interfaces&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">I</span> <span class="n">am</span> <span class="n">here</span>
</pre></div>
</div>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X</th>
      <th>Y</th>
      <th>Z</th>
      <th>formation</th>
      <th>labels</th>
      <th>series</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.5</td>
      <td>4.0</td>
      <td>7.0</td>
      <td>Layer 1</td>
      <td>${\bf{x}}_{\alpha \, 0}^1$</td>
      <td>Default serie</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.5</td>
      <td>Layer 1</td>
      <td>${\bf{x}}_{\alpha \, 1}^1$</td>
      <td>Default serie</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.0</td>
      <td>4.0</td>
      <td>7.0</td>
      <td>Layer 1</td>
      <td>${\bf{x}}_{\alpha \, 2}^1$</td>
      <td>Default serie</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>Layer 1</td>
      <td>${\bf{x}}_{\alpha \, 3}^1$</td>
      <td>Default serie</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>Layer 2</td>
      <td>${\bf{x}}_{\alpha \, 0}^2$</td>
      <td>Default serie</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>Layer 2</td>
      <td>${\bf{x}}_{\alpha \, 1}^2$</td>
      <td>Default serie</td>
    </tr>
    <tr>
      <th>6</th>
      <td>8.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>Layer 2</td>
      <td>${\bf{x}}_{\alpha \, 2}^2$</td>
      <td>Default serie</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>Layer 2</td>
      <td>${\bf{x}}_{\alpha \, 3}^2$</td>
      <td>Default serie</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>Layer 2</td>
      <td>${\bf{x}}_{\alpha \, 4}^2$</td>
      <td>Default serie</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>Layer 3</td>
      <td>${\bf{x}}_{\alpha \, 0}^3$</td>
      <td>Default serie</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>Layer 3</td>
      <td>${\bf{x}}_{\alpha \, 1}^3$</td>
      <td>Default serie</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>Layer 3</td>
      <td>${\bf{x}}_{\alpha \, 2}^3$</td>
      <td>Default serie</td>
    </tr>
  </tbody>
</table>
</div><div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">GeMpy</span><span class="o">.</span><span class="n">set_foliations</span><span class="p">(</span><span class="n">geo_data</span><span class="p">,</span> <span class="n">pn</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
                     <span class="s2">&quot;X&quot;</span> <span class="p">:</span> <span class="n">dip_pos_3</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                     <span class="s2">&quot;Y&quot;</span> <span class="p">:</span> <span class="n">dip_pos_3</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                     <span class="s2">&quot;Z&quot;</span> <span class="p">:</span> <span class="n">dip_pos_3</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                     <span class="s2">&quot;azimuth&quot;</span> <span class="p">:</span> <span class="n">azimuth_3</span><span class="p">,</span>
                     <span class="s2">&quot;dip&quot;</span> <span class="p">:</span> <span class="n">dip_angle_3</span><span class="p">,</span>
                     <span class="s2">&quot;polarity&quot;</span> <span class="p">:</span> <span class="n">polarity_3</span><span class="p">,</span>
                     <span class="s2">&quot;formation&quot;</span> <span class="p">:</span> <span class="p">[</span> <span class="s1">&#39;Layer 3&#39;</span><span class="p">],</span>
                     <span class="s2">&quot;labels&quot;</span> <span class="p">:</span> <span class="s1">r&#39;${\bf</span><span class="si">{x}</span><span class="s1">}_{\beta \,</span><span class="si">{2}</span><span class="s1">}$&#39;</span><span class="p">}),</span> <span class="n">append</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">GeMpy</span><span class="o">.</span><span class="n">get_raw_data</span><span class="p">(</span><span class="n">geo_data</span><span class="p">,</span> <span class="s1">&#39;foliations&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>G_x</th>
      <th>G_y</th>
      <th>G_z</th>
      <th>X</th>
      <th>Y</th>
      <th>Z</th>
      <th>azimuth</th>
      <th>dip</th>
      <th>formation</th>
      <th>labels</th>
      <th>polarity</th>
      <th>series</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.258819</td>
      <td>1.584810e-17</td>
      <td>0.965926</td>
      <td>7.0</td>
      <td>4.0</td>
      <td>7.0</td>
      <td>90.0</td>
      <td>15.0</td>
      <td>Layer 1</td>
      <td>${\bf{x}}_{\beta \,{0}}$</td>
      <td>1.0</td>
      <td>Default serie</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.342020</td>
      <td>-2.094269e-17</td>
      <td>0.939693</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>90.0</td>
      <td>340.0</td>
      <td>Layer 2</td>
      <td>${\bf{x}}_{\beta \,{1}}$</td>
      <td>1.0</td>
      <td>Default serie</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0.984808</td>
      <td>6.030208e-17</td>
      <td>0.173648</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>90.0</td>
      <td>80.0</td>
      <td>Layer 3</td>
      <td>${\bf{x}}_{\beta \,{2}}$</td>
      <td>1.0</td>
      <td>Default serie</td>
    </tr>
  </tbody>
</table>
</div><div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">GeMpy</span><span class="o">.</span><span class="n">set_data_series</span><span class="p">(</span><span class="n">geo_data</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;younger&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;Layer 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Layer 2&#39;</span><span class="p">),</span>
                      <span class="s1">&#39;older&#39;</span><span class="p">:</span> <span class="s1">&#39;Layer 3&#39;</span><span class="p">},</span> <span class="n">order_series</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;younger&#39;</span><span class="p">,</span> <span class="s1">&#39;older&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">GeMpy</span><span class="o">.</span><span class="n">plot_data</span><span class="p">(</span><span class="n">geo_data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">Visualization</span><span class="o">.</span><span class="n">PlotData</span> <span class="n">at</span> <span class="mh">0x7fb7d2c3a2b0</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="../_images/Example_2_Simple_22_1.png" src="../_images/Example_2_Simple_22_1.png" />
<p>This potential field gives the following block</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">GeMpy</span><span class="o">.</span><span class="n">plot_potential_field</span><span class="p">(</span><span class="n">geo_data</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="n">n_pf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span>
                           <span class="n">colorbar</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;magma&#39;</span> <span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/Example_2_Simple_24_0.png" src="../_images/Example_2_Simple_24_0.png" />
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">GeMpy</span><span class="o">.</span><span class="n">get_raw_data</span><span class="p">(</span><span class="n">geo_data</span><span class="p">)</span>
</pre></div>
</div>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>G_x</th>
      <th>G_y</th>
      <th>G_z</th>
      <th>X</th>
      <th>Y</th>
      <th>Z</th>
      <th>azimuth</th>
      <th>dip</th>
      <th>formation</th>
      <th>labels</th>
      <th>polarity</th>
      <th>series</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="12" valign="top">interfaces</th>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.5</td>
      <td>4.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Layer 1</td>
      <td>${\bf{x}}_{\alpha \, 0}^1$</td>
      <td>NaN</td>
      <td>younger</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Layer 1</td>
      <td>${\bf{x}}_{\alpha \, 1}^1$</td>
      <td>NaN</td>
      <td>younger</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Layer 1</td>
      <td>${\bf{x}}_{\alpha \, 2}^1$</td>
      <td>NaN</td>
      <td>younger</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Layer 1</td>
      <td>${\bf{x}}_{\alpha \, 3}^1$</td>
      <td>NaN</td>
      <td>younger</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Layer 2</td>
      <td>${\bf{x}}_{\alpha \, 0}^2$</td>
      <td>NaN</td>
      <td>younger</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Layer 2</td>
      <td>${\bf{x}}_{\alpha \, 1}^2$</td>
      <td>NaN</td>
      <td>younger</td>
    </tr>
    <tr>
      <th>6</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Layer 2</td>
      <td>${\bf{x}}_{\alpha \, 2}^2$</td>
      <td>NaN</td>
      <td>younger</td>
    </tr>
    <tr>
      <th>7</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Layer 2</td>
      <td>${\bf{x}}_{\alpha \, 3}^2$</td>
      <td>NaN</td>
      <td>younger</td>
    </tr>
    <tr>
      <th>8</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Layer 2</td>
      <td>${\bf{x}}_{\alpha \, 4}^2$</td>
      <td>NaN</td>
      <td>younger</td>
    </tr>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Layer 3</td>
      <td>${\bf{x}}_{\alpha \, 0}^3$</td>
      <td>NaN</td>
      <td>older</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Layer 3</td>
      <td>${\bf{x}}_{\alpha \, 1}^3$</td>
      <td>NaN</td>
      <td>older</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>9.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Layer 3</td>
      <td>${\bf{x}}_{\alpha \, 2}^3$</td>
      <td>NaN</td>
      <td>older</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">foliations</th>
      <th>0</th>
      <td>0.258819</td>
      <td>1.584810e-17</td>
      <td>0.965926</td>
      <td>7.0</td>
      <td>4.0</td>
      <td>7.0</td>
      <td>90.0</td>
      <td>15.0</td>
      <td>Layer 1</td>
      <td>${\bf{x}}_{\beta \,{0}}$</td>
      <td>1.0</td>
      <td>younger</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.342020</td>
      <td>-2.094269e-17</td>
      <td>0.939693</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>90.0</td>
      <td>340.0</td>
      <td>Layer 2</td>
      <td>${\bf{x}}_{\beta \,{1}}$</td>
      <td>1.0</td>
      <td>younger</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0.984808</td>
      <td>6.030208e-17</td>
      <td>0.173648</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>90.0</td>
      <td>80.0</td>
      <td>Layer 3</td>
      <td>${\bf{x}}_{\beta \,{2}}$</td>
      <td>1.0</td>
      <td>older</td>
    </tr>
  </tbody>
</table>
</div><p>Combining both potential field where the first potential field is
younger than the second we can obtain the following structure.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">GeMpy</span><span class="o">.</span><span class="n">compute_block_model</span><span class="p">(</span><span class="n">geo_data</span><span class="p">,</span> <span class="n">series_number</span><span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">GeMpy</span><span class="o">.</span><span class="n">plot_section</span><span class="p">(</span><span class="n">geo_data</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">Visualization</span><span class="o">.</span><span class="n">PlotData</span> <span class="n">at</span> <span class="mh">0x7fb7c35cd828</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="../_images/Example_2_Simple_27_1.png" src="../_images/Example_2_Simple_27_1.png" />
<div class="section" id="side-note-example-of-covariances-involved-in-the-cokriging-system">
<h3>Side note: Example of covariances involved in the cokriging system<a class="headerlink" href="#side-note-example-of-covariances-involved-in-the-cokriging-system" title="Permalink to this headline">¶</a></h3>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">plot_potential_var</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">14</span> <span class="o">/</span> <span class="mi">3</span>  <span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>

<span class="n">plot_all</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">14</span> <span class="o">/</span> <span class="mi">3</span>  <span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span> <span class="c1"># 0**2 /14/3</span>
</pre></div>
</div>
<img alt="../_images/Example_2_Simple_29_0.png" src="../_images/Example_2_Simple_29_0.png" />
<img alt="../_images/Example_2_Simple_29_1.png" src="../_images/Example_2_Simple_29_1.png" />
<img alt="../_images/Example_2_Simple_29_2.png" src="../_images/Example_2_Simple_29_2.png" />
<img alt="../_images/Example_2_Simple_29_3.png" src="../_images/Example_2_Simple_29_3.png" />
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="../GeMpy Introduction.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../GeMpy Introduction.html">Welcome to GeMpy&#8217;s documentation!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Kriging.html">Kriging structure of the <em>Potential field method</em></a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorial.html">Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Example_1_Sandstone_Project.html">Example 1: Sandstone Model</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Example 2: Simple model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#importing-dependencies">Importing dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interactive-pandas-dataframe">Interactive pandas Dataframe</a></li>
<li class="toctree-l3"><a class="reference internal" href="#combining-potential-fields-depositional-series">Combining potential fields: Depositional series</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Example_3_Simple_PyMC.html">Example 3: Simple model PyMC</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../code.html">Code</a></li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../GeMpy Introduction.html">Documentation overview</a><ul>
  <li><a href="../tutorial.html">Tutorial</a><ul>
      <li>Previous: <a href="Example_1_Sandstone_Project.html" title="previous chapter">Example 1: Sandstone Model</a></li>
      <li>Next: <a href="Example_3_Simple_PyMC.html" title="next chapter">Example 3: Simple model PyMC</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/Notebooks/Example_2_Simple.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Miguel de la Varga. NRE-RWTH team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.9</a>
      
      |
      <a href="../_sources/Notebooks/Example_2_Simple.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>